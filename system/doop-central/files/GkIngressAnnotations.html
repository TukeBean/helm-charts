<p>This check validates annotations on Ingress objects.</p>
<dl>
  <dt>Why is this a problem?</dt>
  <dd>
    Usage of <code>-snippet</code> annotations is not allowed to prevent unauthorized
    access to Kubernetes objects as described in CVE-2021-25742.
    <br><br>
    Starting in v0.22.0, Ingress definitions using the annotation
    <code>rewrite-target</code> are not backwards compatible with previous versions. In
    v0.22.0 and beyond, any substrings within the request URI that need to be passed to
    the rewritten path must explicitly be defined in a capture group.
  </dd>
  <dt>How to fix?</dt>
  <dd>
    If you specify a <code>-snippet</code> annotation on your Ingress, it is essentially a
    no-op (i.e. ineffective). If needed, they must go to the Ingress controller
    configuration. Get in touch with Arno Uhlig for a solution.
    <br><br>
    For <code>rewrite-target</code> annotation, you must switch to the new syntax
    (<a href="https://github.com/kubernetes/ingress-nginx/blob/main/docs/examples/rewrite/README.md#rewrite-target">example</a>).
  </dd>
</dl>
